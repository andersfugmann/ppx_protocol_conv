<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Helper (ppx_protocol_conv.Protocol_conv.Runtime.Helper)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../../index.html">ppx_protocol_conv</a> &#x00BB; <a href="../../index.html">Protocol_conv</a> &#x00BB; <a href="../index.html">Runtime</a> &#x00BB; Helper</nav><h1>Module <code>Runtime.Helper</code></h1><p>Module contains helper function for serializing and deserializing tuples, records and variants. Deserialization functions may raise <code>Helper.Protocol</code> exception. It is recommended that the calling functions convert this exception into a <code>Driver.Protocol_exception</code></p></header><aside><p>Tail recursive version of map</p></aside><dl><dt class="spec value" id="val-list_map"><a href="#val-list_map" class="anchor"></a><code><span class="keyword">val</span> list_map : <span>f:<span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> list</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> list</span></code></dt></dl><dl><dt class="spec exception" id="exception-Protocol_error"><a href="#exception-Protocol_error" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Protocol_error</span> <span class="keyword">of</span> string</code></dt><dd><p>Excpetion raised if the type could not be serialized</p></dd></dl><dl><dt class="spec value" id="val-map_record_in"><a href="#val-map_record_in" class="anchor"></a><code><span class="keyword">val</span> map_record_in : t a b. <span>(string <span>&#45;&gt;</span> string)</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'t</span>, <span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="../Record_in/index.html#type-t">Record_in.t</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'t</span>, <span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="../Record_in/index.html#type-t">Record_in.t</a></span></code></dt><dd><p>Map fields names of a <code>Record_in</code> structure</p></dd></dl><dl><dt class="spec value" id="val-to_record"><a href="#val-to_record" class="anchor"></a><code><span class="keyword">val</span> to_record : t constr b. <span>?&#8288;strict:bool</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'t</span>, <span class="type-var">'constr</span>, <span class="type-var">'b</span>)</span> <a href="../Record_in/index.html#type-t">Record_in.t</a></span> <span>&#45;&gt;</span> <span class="type-var">'constr</span> <span>&#45;&gt;</span> <span><span>(string * <span class="type-var">'t</span>)</span> list</span> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dd><p><code>to_record spec constructor ts</code> returns the constructed value. <code>ts</code> is a associative array <code>(string * t)</code> list, mapping fields to the deserialized value <code>t</code> if <code>strict</code> is true, an error will be raised if input contains an unknown field. If dublicate fields are found in the input, an error is raised</p></dd></dl><dl><dt class="spec value" id="val-map_record_out"><a href="#val-map_record_out" class="anchor"></a><code><span class="keyword">val</span> map_record_out : t a. <span>(string <span>&#45;&gt;</span> string)</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'t</span>, <span class="type-var">'a</span>, <span class="type-var">'t</span>)</span> <a href="../Record_out/index.html#type-t">Record_out.t</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'t</span>, <span class="type-var">'a</span>, <span class="type-var">'t</span>)</span> <a href="../Record_out/index.html#type-t">Record_out.t</a></span></code></dt><dd><p>Map fields names of a <code>Record_out</code> structure</p></dd></dl><dl><dt class="spec type" id="type-serialize_record"><a href="#type-serialize_record" class="anchor"></a><code><span class="keyword">type</span> <span>'t serialize_record</span></code><code> = <span><span>(string * <span class="type-var">'t</span>)</span> list</span> <span>&#45;&gt;</span> <span class="type-var">'t</span></code></dt></dl><dl><dt class="spec value" id="val-of_record"><a href="#val-of_record" class="anchor"></a><code><span class="keyword">val</span> of_record : a t. <span>omit_default:bool</span> <span>&#45;&gt;</span> <span><span class="type-var">'t</span> <a href="index.html#type-serialize_record">serialize_record</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'t</span>, <span class="type-var">'a</span>, <span class="type-var">'t</span>)</span> <a href="../Record_out/index.html#type-t">Record_out.t</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>of_record map_f spec</code> produces a valid deserialisation function for a record type The <code>map_f</code> function is called to produce the serialized result from a field_name, t association list. If <code>omit_default</code> is true, then default values are omitted from the output</p></dd></dl><dl><dt class="spec value" id="val-to_tuple"><a href="#val-to_tuple" class="anchor"></a><code><span class="keyword">val</span> to_tuple : t a b. <span><span>(<span class="type-var">'t</span>, <span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <a href="../Tuple_in/index.html#type-t">Tuple_in.t</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'t</span> list</span> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dd><p><code>to_tuple spec tlist</code> produces a tuple from the serialized values in <code>tlist</code></p></dd></dl><dl><dt class="spec type" id="type-serialize_tuple"><a href="#type-serialize_tuple" class="anchor"></a><code><span class="keyword">type</span> <span>'t serialize_tuple</span></code><code> = <span><span class="type-var">'t</span> list</span> <span>&#45;&gt;</span> <span class="type-var">'t</span></code></dt></dl><dl><dt class="spec value" id="val-of_tuple"><a href="#val-of_tuple" class="anchor"></a><code><span class="keyword">val</span> of_tuple : t a. <span><span class="type-var">'t</span> <a href="index.html#type-serialize_tuple">serialize_tuple</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'t</span>, <span class="type-var">'a</span>, <span class="type-var">'t</span>)</span> <a href="../Tuple_out/index.html#type-t">Tuple_out.t</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt></dl><dl><dt class="spec type" id="type-serialize_variant"><a href="#type-serialize_variant" class="anchor"></a><code><span class="keyword">type</span> <span>'t serialize_variant</span></code><code> = string <span>&#45;&gt;</span> <span><span class="type-var">'t</span> list</span> <span>&#45;&gt;</span> <span class="type-var">'t</span></code></dt></dl><dl><dt class="spec value" id="val-of_variant"><a href="#val-of_variant" class="anchor"></a><code><span class="keyword">val</span> of_variant : t. <span><span class="type-var">'t</span> <a href="index.html#type-serialize_variant">serialize_variant</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span>(<span class="type-var">'t</span>, <span class="type-var">'a</span>, <span class="type-var">'t</span>)</span> <a href="../Tuple_out/index.html#type-t">Tuple_out.t</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>of_variant spec v</code> serializes v and returns the serialized values as a list or map</p></dd></dl><dl><dt class="spec value" id="val-map_constructor_names"><a href="#val-map_constructor_names" class="anchor"></a><code><span class="keyword">val</span> map_constructor_names : <span>(string <span>&#45;&gt;</span> string)</span> <span>&#45;&gt;</span> <span><span><span>(<span class="type-var">'t</span>, <span class="type-var">'a</span>)</span> <a href="../Variant_in/index.html#type-t">Variant_in.t</a></span> list</span> <span>&#45;&gt;</span> <span><span><span>(<span class="type-var">'t</span>, <span class="type-var">'a</span>)</span> <a href="../Variant_in/index.html#type-t">Variant_in.t</a></span> list</span></code></dt><dd><p>Map field names in all inline records of the spec</p></dd></dl><dl><dt class="spec value" id="val-to_variant"><a href="#val-to_variant" class="anchor"></a><code><span class="keyword">val</span> to_variant : <span><span><span>(<span class="type-var">'t</span>, <span class="type-var">'a</span>)</span> <a href="../Variant_in/index.html#type-t">Variant_in.t</a></span> list</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span class="type-var">'t</span> list</span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt></dl></div></body></html>